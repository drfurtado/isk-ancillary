% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{exam}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% Using xcolors with dvipsnames before mdframed to avoid option clash
\usepackage{xcolor}
\usepackage[framemethod=TikZ]{mdframed}

% Defining the base style of the box as bbox
\mdfdefinestyle{bbox}{
  leftmargin = 0cm,%
  rightmargin = 0cm,%
  innerleftmargin = 0.5cm,%
  innerrightmargin = 0.5cm,%
  roundcorner = 5pt,%
  linewidth = 2pt,%
  nobreak=false%,
  %needspace=1in % Trying to avoid a page break after the title but does not do the trick...
}

% Defining custom box environment (cbox) with 2 arguments:
% The first optional (defaults to empty string) is the title of the box
% The second (mandatory) defines the color of the box (linecolor and background is linecolor!30)

% body: fill (#2), colour (#3)
% header: fill (#4), colour (#5)
\newenvironment{cbox}[5][]{
  \def\temp{#1}\ifx\temp\empty
    \begin{mdframed}[style=bbox,%
      linecolor = #4,%
      fontcolor = #3,%
      innertopmargin = 10pt,%
      skipabove = 10pt,%
      backgroundcolor = #2]%
  \else
    \begin{mdframed}[style=bbox,%
      linecolor = #4,%
      fontcolor = #3,%
      backgroundcolor = #2,%
      innertopmargin = 3pt,%
      skipabove = 10pt,%
      frametitle={\tikz[baseline = (current bounding box.east), outer sep = 0pt]
                  \node[anchor = east, rounded corners = 3pt, rectangle, color = #5, fill = #4]{#1};},%
                        frametitleaboveskip = \dimexpr-\ht\strutbox\relax]
  \fi
}{\end{mdframed}}

\mdfdefinestyle{input}{
  frametitle = {},%
  leftmargin = 0cm,%
  rightmargin = 0cm,%
  innerleftmargin = 0.2cm,%
  innerrightmargin = 0.2cm,%
  innertopmargin=0.5em,%
  roundcorner = 2pt,%
  linecolor = lightgray,%
  linewidth = 1pt,%
  backgroundcolor = lightgray!30
}

% Defining cbox macro to draw a coloured block
% around the content

\newcommand{\cboxs}[5][]{\begin{cbox}[#1]{#2}{#3}{#4}{#5}}
\newcommand{\cboxe}{\end{cbox}}

\makeatletter
% Collection of macros calling the MCQ environments from
%  the exam class instead of the itemize environment

% Backing up item and the itemize environment.
\let\origitem\item
\let\origitemize\itemize
\let\origenditemize\enditemize

% Macro to restore the original itemize environment
\newcommand{\restoreitemize}{
  \let\itemize\origitemize
  \let\enditemize\origenditemize
  \let\item\origitem
}

\newcommand{\opc}[1]{
  \ifstrequal{#1}{on}{
    \let\itemize\oneparchoices
    \let\enditemize\endoneparchoices
    \def\item{\choice}
  }{\restoreitemize}
}

\newcommand{\opcb}[1]{
  \ifstrequal{#1}{on}{
    \let\itemize\oneparcheckboxes
    \let\enditemize\endoneparcheckboxes
    \def\item{\choice}
  }{\restoreitemize}
}

\newcommand{\cb}[1]{
  \ifstrequal{#1}{on}{
    \let\itemize\checkboxes
    \let\enditemize\endcheckboxes
    \def\item{\choice}
  }{\restoreitemize}
}

\newcommand{\ch}[1]{
  \ifstrequal{#1}{on}{
    \let\itemize\choices
    \let\enditemize\endchoices
    \def\item{\choice}
  }{\restoreitemize}
}
\makeatother

% Alternative oneparchoices and oneparcheckboxes
% with equally spaced horizontal items.
% The number of items per line can be adjusted (defaults to 3)
%
% Taken and adapted from the following stackexchange post:
  % http://tex.stackexchange.com/questions/149101/inline-arrangement-using-enumitem

\usepackage{environ, multido, calc}% http://ctan.org/pkg/{environ,multido,calc}
\makeatletter
% Taken from http://tex.stackexchange.com/a/128318/5764
\newcounter{listcount}% Keep track of \item
\newcounter{q}% Enumerate the different items

\NewEnviron{oneparchoicesalt}[1][\perline]{%
  \setcounter{listcount}{0}% Start with 0 \items
  \g@addto@macro{\BODY}{\item\relax\item}% Used to delimit the items; last item identified by \item\relax\item
  \def\item##1\item{% Redefine \item to capture contents
  \def\optarg{##1}%
    \expandafter\ifx\optarg\relax\else% Last item not reached
    \stepcounter{listcount}% Next item being processed
    \expandafter\gdef\csname inlineitem@\thelistcount\endcsname{##1}% Store item in control sequence
    \expandafter\item% Recursively continue processing items
    \fi
    }%
    \BODY% Process environment (save items)
    \setlength{\@tempdima}{\linewidth/#1}% Set length of each \item \parbox; possibly corrent...
        \ifnum\value{listcount}<#1\relax\setlength{\@tempdima}{\linewidth/\value{listcount}}\fi%... if needed
        \par\noindent% Start new non-indented paragraph
      \multido{\i=1+1}{\value{listcount}}{% Insert all items in a \parbox
        \parbox[t]{\@tempdima}{\raggedright\hangindent=1.5em\hangafter=1% Paragraph formatting
        \makebox[1.5em][r]{ \setcounter{q}{\i}
          \opccounter\space}\strut\csname inlineitem@\i\endcsname\strut}\hspace{0pt}}%
    }
    
    
    \newcommand{\perline}{3}
    \newcommand{\opccounter}{\Alph{q})}
    \newcommand{\opcalt}[2][3]{
      % Passing variables with the help of macros
      % and not arguments to homogenize the call.
      \renewcommand{\perline}{#1}
        \renewcommand{\opccounter}{\Alph{q})}
        \ifstrequal{#2}{on}{
          % Switching itemize to MCQ mode
          \let\itemize\oneparchoicesalt
          \let\enditemize\endoneparchoicesalt
        }{\restoreitemize}
      }
      
      \newcommand{\opcbalt}[2][3]{
        % Passing variables with the help of macros
        % and not arguments to homogenize the call.
        \renewcommand{\perline}{#1}
          \renewcommand{\opccounter}{\checkbox@char}
          \ifstrequal{#2}{on}{
            % Switching itemize to MCQ mode
            \let\itemize\oneparchoicesalt
            \let\enditemize\endoneparchoicesalt
          }{\restoreitemize}
}

\makeatother

% Including total page numbers in footer
\lfoot{}
\cfoot{Page \thepage\ of \numpages}
\rfoot{}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Title},
  pdfauthor={John Doe},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Title}
\author{John Doe}
\date{11 April, 2022}

\begin{document}
\maketitle

\begin{mdframed}[roundcorner = 2pt, linewidth = 1pt]
\vspace{0.1in}
\makebox[\textwidth]{{\fontfamily{phv}\selectfont \Large First name:}\enspace\hrulefill}
\\[12pt]
\vspace{0.2in}
\makebox[\textwidth]{{\fontfamily{phv}\selectfont \Large Last name:}\enspace\hrulefill}
\end{mdframed}

\hypertarget{multiple-choice-question}{%
\subparagraph{Multiple choice question}\label{multiple-choice-question}}

\opc{on}

\begin{itemize}
\tightlist
\item
  Item 1
\item
  Item 2
\item
  Item 3
\end{itemize}

\opc{off}

\hypertarget{question}{%
\subparagraph{Question}\label{question}}

\fillwithdottedlines{0.5in}\vspace{2em}

\end{document}
